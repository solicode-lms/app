#### Modification de la base de données

- **Règle globale :**  
  - Toute table **nouvellement créée** doit contenir une colonne `reference` (type string) avec la contrainte `unique`.  
  - Si l’on ajoute des colonnes à une table existante, la colonne `reference` n’est pas requise (elle existe déjà).

- **Opérations autorisées :**  
  1. **Créer une nouvelle table**  
  2. **Ajouter une colonne** à une table existante  

- **Détection automatique du module :**  
  1. **Présentation du besoin :**  
     - Lorsque l’utilisateur demande simplement “Créer la table `NomDeLaTable`”, l’agent doit :  
       - Analyser le nom de la table (`NomDeLaTable`).  
       - Chercher, dans sa connaissance des modules existants, celui qui est le plus cohérent avec cette table (par exemple :  
         - Les tables liées aux « projets » et « réalisations de projets » doivent aller dans `PkgGestionTaches`.  
         - Les tables liées aux entités génériques (utilisateurs, rôles, paramètres système…) vont dans `Core`.  
         - Les tables d’associations ou de cotisations vont dans `PkgGestionAssociation`.  
         - Etc.)  
       - Si un mapping est trouvé sans ambiguïté, déduire automatiquement `<NomDuModule>`.  
       - Sinon (aucune correspondance claire ou plusieurs modules potentiels), poser une question de validation :
         > « Je n'arrive pas à déterminer dans quel module placer la table `NomDeLaTable`. Dans quel module souhaitez-vous la créer ? (par ex. : Core, PkgGestionTaches, PkgGestionAssociation, etc.) »

  2. **Construction de la commande de migration :**  
     - Une fois `<NomDuModule>` déterminé (par inférence ou réponse de l’utilisateur), l’agent génère la commande :  
       ```bash
       php artisan make:module-migration create_<nom_table>_table <NomDuModule>
       ```  
       où `<nom_table>` est le nom en minuscules et underscore de la table (par ex. `etat_evaluation_realisation_projets` pour « EtatEvaluationRealisationProjet »).

- **Exemple concret de dialogue attendu :**  
  1. **Utilisateur** : « Créer la table `EtatEvaluationRealisationProjet`. »  
  2. **Agent** (inférence) :  
     - Le nom contient “Etat” et “RealisationProjet” ⇒ correspond à une table de suivi d’évaluation de projets ⇒ module probable : `PkgGestionTaches`.  
     - **Agent (réponse)** :  
       ```
       J’ai détecté que « EtatEvaluationRealisationProjet » correspond au module “PkgGestionTaches”.  
       Voici la commande pour générer la migration :
       php artisan make:module-migration create_etat_evaluation_realisation_projets_table PkgGestionTaches
       ```
  3. **Cas d’ambiguïté**  
     - **Utilisateur** : « Créer la table `SettingGlobal`. »  
     - **Agent (aucune correspondance claire)** :  
       ```
       Je n’arrive pas à déterminer dans quel module placer la table “SettingGlobal”.  
       Dans quel module souhaitez-vous la créer ? (par ex. : Core, PkgGestionTaches, PkgGestionAssociation, etc.)
       ```

- **Exemple d’un fichier de migration conforme**  
  ```php
  <?php

  use Illuminate\Database\Migrations\Migration;
  use Illuminate\Database\Schema\Blueprint;
  use Illuminate\Support\Facades\Schema;

  return new class extends Migration
  {
      public function up()
      {
          Schema::create('etat_realisation_taches', function (Blueprint $table) {
              $table->id();

              // Colonne 'reference' obligatoire et unique
              $table->string('reference')->unique();

              $table->string('nom');
              $table->longText('description')->nullable();
              $table->boolean('is_editable_only_by_formateur')
                    ->default(false)
                    ->nullable();
              $table->foreignId('formateur_id')
                    ->constrained('formateurs')
                    ->onDelete('cascade');
              $table->foreignId('sys_color_id')
                    ->constrained('sys_colors');
              $table->timestamps();
          });
      } 

      public function down()
      {
          Schema::dropIfExists('etat_realisation_taches');
      }
  };


La commande pour migration : 

````bash
php artisan make:module-migration create_<nom_table>_table <NomDuModule>
````