
### âœ… CrÃ©ation dâ€™une nouvelle mÃ©thode dans un Service

#### ğŸ¯ Objectif  
CrÃ©er une nouvelle mÃ©thode mÃ©tier dans une classe `Service` tout en respectant la logique dÃ©jÃ  existante pour garantir **cohÃ©rence**, **rÃ©utilisabilitÃ©** et **maintenabilitÃ©**.

---

### ğŸ§± RÃ¨gles Ã  suivre

1. **RÃ©utilisation prioritaire des mÃ©thodes existantes**
   - Utiliser en prioritÃ© les mÃ©thodes CRUD fournies par le `CrudTrait` :
     - `all()`, `find()`, `create()`, `update()`, `destroy()`, `edit()`, `updateOnlyExistanteAttribute()`, `updateOrCreate()`, `getByReference()`, `createInstance()`
   - Utiliser les mÃ©thodes utilitaires :
     - `hasOrdreColumn()`, `getNextOrdre()`, `reorderOrdreColumn()`
   - Lors de lâ€™utilisation d'entitÃ©s secondaires (ex. : `RealisationTache`), **toujours passer par leur propre service dÃ©diÃ©** (ex. : `RealisationTacheService`) au lieu dâ€™un appel direct au modÃ¨le.

2. **CrÃ©er une mÃ©thode uniquement si elle est spÃ©cifique au mÃ©tier**
   - Exemple : `getEtatInitialByFormateur()`, `synchroniserTachesDuProjet($projetId)`
   - La mÃ©thode doit encapsuler un **traitement fonctionnel clair**.

3. **Utiliser les outils fournis par la classe `Service`**
   - `$this->model` pour manipuler l'entitÃ© principale
   - `$this->viewState`, `$this->sessionState` pour le contexte utilisateur
   - Injecter ou instancier les services secondaires de maniÃ¨re explicite :
     ```php
     $realisationTacheService = new RealisationTacheService();
     $realisationTacheService->create([...]);
     ```

4. **Encapsuler les traitements complexes**
   - Si la logique comporte plusieurs Ã©tapes (ex. crÃ©ation dâ€™un projet et ses tÃ¢ches), la diviser en **mÃ©thodes privÃ©es**, ou bien utiliser des services mÃ©tiers complÃ©mentaires.

---

### ğŸ§° Liste des mÃ©thodes disponibles

#### ğŸ“¦ MÃ©thodes CRUD (`CrudTrait`)

- `all()`
- `find(int $id)`
- `create(array|Model $data)`
- `update($id, array $data)`
- `destroy($id)`
- `edit($id)`
- `updateOnlyExistanteAttribute($id, array $data)`
- `updateOrCreate(array $attributes, array $values)`
- `getByReference(string $reference)`
- `createInstance(array $data = [])`

#### âš™ï¸ MÃ©thodes utilitaires internes

- `hasOrdreColumn()`
- `getNextOrdre()`
- `reorderOrdreColumn(?int $ancienOrdre, int $nouvelOrdre, int $idEnCours = null)`

---

### ğŸ’¡ Exemples de mÃ©thodes mÃ©tier valides

- `getTachesByProjetId(int $projetId)`
- `synchroniserRealisationTaches(int $realisationProjetId)` â†’ via `RealisationTacheService`
- `getDefaultEtatByFormateurId(int $formateurId)`
- `dupliquerAvecRelations(int $idOriginal)`

