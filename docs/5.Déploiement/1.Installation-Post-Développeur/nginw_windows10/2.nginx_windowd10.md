## 1. Installer les prérequis

### 1.1 PHP pour Windows

1. Télécharge PHP **Non Thread Safe (NTS)** depuis :
   [https://windows.php.net/download/](https://windows.php.net/download/)
   (ex : PHP 8.3 NTS x64)
2. Décompresse dans `C:\php`
3. Copie `php.ini-development` → `php.ini`
4. Ouvre `php.ini` et active les extensions utiles :

   ```ini
   extension_dir = "ext"
   extension=fileinfo
   extension=mbstring
   extension=mysqli
   extension=pdo_mysql
   extension=openssl
   extension=curl
   extension=zip
   ```
5. Ajoute `C:\php` au **PATH** Windows (Panneau de config → Système → Paramètres avancés → Variables d’environnement).

---

### 1.2 Composer

1. Télécharge l’installateur : [https://getcomposer.org/download/](https://getcomposer.org/download/)
2. Installe et vérifie :

   ```powershell
   composer -V
   ```

---

### 1.3 MySQL / MariaDB

* Télécharge **MariaDB** (plus léger) : [https://mariadb.org/download/](https://mariadb.org/download/)
* Installe avec mot de passe root (ex : `root`).

---

### 1.4 Nginx pour Windows

1. Télécharge : [http://nginx.org/en/download.html](http://nginx.org/en/download.html)
   (version stable Win64)
2. Décompresse dans `C:\nginx`

---

## 2. Préparer Laravel

### 2.1 Télécharger le projet

```powershell
cd C:\nginx\html
git clone https://github.com/ton-repo/monapp.git
cd monapp
composer install --no-dev --optimize-autoloader
copy .env.example .env
php artisan key:generate
```

---

### 2.2 Configurer `.env`

Exemple minimal :

```env
APP_NAME=Laravel
APP_ENV=production
APP_KEY=base64:...
APP_DEBUG=false
APP_URL=http://localhost

DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=monapp
DB_USERNAME=root
DB_PASSWORD=root
```

---

### 2.3 Créer la base

```powershell
mysql -u root -p
CREATE DATABASE monapp CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
EXIT;
```

---

### 2.4 Migrations et optimisations

```powershell
php artisan migrate --force
php artisan config:cache
php artisan route:cache
php artisan view:cache
php artisan storage:link
```

---

## 3. Configurer PHP-FPM pour Nginx

### 3.1 Lancer PHP-FPM

PHP pour Windows ≥8.0 inclut **php-fpm.exe**.

Crée `C:\php\php-fpm.conf` :

```ini
[global]
error_log = C:/php/logs/php-fpm.log

[www]
listen = 127.0.0.1:9000
listen.allowed_clients = 127.0.0.1
user = nobody
group = nobody
pm = dynamic
pm.max_children = 5
pm.start_servers = 2
pm.min_spare_servers = 1
pm.max_spare_servers = 3
```

Lancer :

```powershell
cd C:\php
php-fpm.exe -y php-fpm.conf
```

---

## 4. Configurer Nginx

Dans `C:\nginx\conf\nginx.conf` :

```nginx
worker_processes  1;

events {
    worker_connections  1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;

    sendfile        on;
    keepalive_timeout  65;

    server {
        listen       80;
        server_name  localhost;

        root   C:/nginx/html/monapp/public;
        index  index.php index.html;

        location / {
            try_files $uri $uri/ /index.php?$query_string;
        }

        location ~ \.php$ {
            include        fastcgi_params;
            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
            fastcgi_pass   127.0.0.1:9000;
            fastcgi_index  index.php;
        }

        location ~* \.(jpg|jpeg|png|gif|ico|css|js)$ {
            expires 7d;
            access_log off;
        }
    }
}
```

---

## 5. Lancer les services

Dans **2 fenêtres PowerShell** séparées :

```powershell
# Fenêtre 1 - PHP-FPM
cd C:\php
php-fpm.exe -y php-fpm.conf
```

```powershell
# Fenêtre 2 - Nginx
cd C:\nginx
start nginx
```

Accède sur [http://localhost](http://localhost)

---

## 6. Lancer les jobs Laravel

### 6.1 Scheduler

Planificateur de tâches Windows :

* Action : `php`
* Arguments : `artisan schedule:run`
* Démarrer dans : `C:\nginx\html\monapp`
* Déclencheur : chaque minute

### 6.2 Queue Worker

Utilise [NSSM](https://nssm.cc/) pour créer un service Windows :

```powershell
nssm install laravel-queue "C:\php\php.exe" "artisan queue:work --sleep=3 --tries=3"
```

---

## 7. Tests finaux

1. Accès à la page d’accueil Laravel → OK
2. Accès à une route API → OK
3. Upload de fichiers → OK (`php.ini` : `upload_max_filesize` et `post_max_size` adaptés)
4. Jobs artisan → OK

---

Si tu veux, je peux te préparer **un pack prêt-à-décompresser** avec :

* Nginx configuré
* PHP-FPM configuré
* Un script `.bat` pour lancer tout en un seul clic
  Ce qui éviterait toute la partie configuration manuelle.

Veux-tu que je te le prépare ?
